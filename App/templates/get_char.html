<!DOCTYPE HTML>
<html>
<head>
    <title>Flask-SocketIO Test</title>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        function onButtonClick() {
          let serviceUuid = "0xba10";
          if (serviceUuid.startsWith('0x')) {
            serviceUuid = parseInt(serviceUuid);
          }

          let characteristicUuid = document.querySelector('#characteristic').value;
          if (characteristicUuid.startsWith('0x')) {
            characteristicUuid = parseInt(characteristicUuid);
          }

          log('Requesting Bluetooth Device...');
          navigator.bluetooth.requestDevice({filters: [{services: [serviceUuid]}]})
          .then(device => {
            log('Connecting to GATT Server...');
            return device.gatt.connect();
          })
          .then(server => {
            log('Getting Service...');
            return server.getPrimaryService(serviceUuid);
          })
          .then(service => {
            log('Getting Characteristics...');
            if (characteristicUuid) {
              // Get all characteristics that match this UUID.
              return service.getCharacteristics(characteristicUuid);
            }
            // Get all characteristics.
            return service.getCharacteristics();
          })
          .then(characteristics => {
            log('> Characteristics: ' +
              characteristics.map(c => c.uuid).join('\n' + ' '.repeat(19)));
          })
          .catch(error => {
            log('Argh! ' + error);
          });
        }
    </script>
</head>
<body>
    <h2>Receive:</h2>
    <button onclick="onButtonClick()">Click me</button>
</body>